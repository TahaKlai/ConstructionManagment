<div class="dashboard-container bg-light min-vh-100">
  <!-- Enhanced Professional Header -->
  <div class="dashboard-header bg-white shadow-sm border-bottom">
    <div class="container-fluid py-3">
      <div class="row align-items-center">
        <div class="col-md-6">
          <div class="d-flex align-items-center">
            <div class="logo-section me-4">
              <div class="logo-icon bg-primary text-white rounded-circle p-3 me-3">
                <i class="fas fa-building fa-2x"></i>
              </div>
              <div class="header-text">
                <h2 class="mb-0 text-primary fw-bold">Construction Manager Pro</h2>
                <span class="text-muted">Project Management Dashboard</span>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="d-flex justify-content-end align-items-center">
            <div class="live-tasks-section me-4">
              <div class="row g-3">
                <div class="col">
                  <div class="stat-card bg-success text-white rounded p-3 text-center">
                    <div class="h4 mb-1">{{ currentLiveTasks }}</div>
                    <small>Active Tasks</small>
                  </div>
                </div>
                <div class="col">
                  <div class="stat-card bg-info text-white rounded p-3 text-center">
                    <div class="h4 mb-1">{{ currentCompletedTasks }}</div>
                    <small>Completed</small>
                  </div>
                </div>
              </div>
            </div>
            <div class="date-range-selector me-3">
              <div class="input-group">
                <input type="date" [(ngModel)]="startDate" class="form-control">
                <span class="input-group-text">to</span>
                <input type="date" [(ngModel)]="endDate" class="form-control">
              </div>
            </div>
            
            <!-- Debug buttons (temporary) -->
            <button class="btn btn-warning btn-sm me-2" (click)="forceAdminRole()">Set Admin</button>
            <button class="btn btn-info btn-sm me-2" (click)="testDropdown()">Test Dropdown</button>
            <button class="btn btn-danger btn-sm me-2" (click)="clearAuth()">Clear Auth</button>
            <span class="badge bg-secondary me-2">{{ isAdmin ? 'ADMIN' : 'USER' }}</span>
            
            <!-- SIMPLIFIED Profile Dropdown -->
            <div class="user-dropdown-container">
              <button 
                class="user-dropdown-button" 
                (click)="toggleDropdown($event)"
                [class.active]="dropdownOpen">
                <i class="fas fa-user-circle fa-lg" 
                   [class.text-warning]="isAdmin" 
                   [class.text-primary]="!isAdmin"></i>
                <span>{{ userRole }}</span>
                <i class="fas fa-chevron-down" [class.rotate]="dropdownOpen"></i>
              </button>
              
              <div class="user-dropdown-menu" [class.show]="dropdownOpen">
                <a class="dropdown-link" (click)="onProfileClick($event)">
                  <i class="fas fa-user"></i>
                  Profile
                </a>
                @if (isAdmin) {
                  <a class="dropdown-link admin" (click)="onAdminPanelClick($event)">
                    <i class="fas fa-crown"></i>
                    Admin Panel
                  </a>
                }
                <a class="dropdown-link" (click)="onSettingsClick($event)">
                  <i class="fas fa-cog"></i>
                  Settings
                </a>
                <hr class="dropdown-divider">
                <a class="dropdown-link logout" (click)="logout($event)">
                  <i class="fas fa-sign-out-alt"></i>
                  Logout
                </a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Professional KPI Cards -->
  <div class="container-fluid py-4">
    <div class="row g-4 mb-4">
      <!-- Risk Assessment Card -->
      <div class="col-xl-6 col-lg-12">
        <app-risk-assessment></app-risk-assessment>
      </div>
      
      <div class="col-xl-3 col-lg-6">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="flex-shrink-0">
                <div class="bg-primary bg-gradient rounded-circle p-3">
                  <i class="fas fa-project-diagram text-white"></i>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <div class="text-muted small">Total Projects</div>
                <div class="h3 mb-0">{{ totalProjects }}</div>
                <div class="text-success small">
                  <i class="fas fa-arrow-up"></i> {{ projectsOnTime }}/{{ totalProjects }} on time
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-xl-3 col-lg-6">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="flex-shrink-0">
                <div class="bg-success bg-gradient rounded-circle p-3">
                  <i class="fas fa-euro-sign text-white"></i>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <div class="text-muted small">Total Revenue</div>
                <div class="h3 mb-0">€{{ (totalRevenue / 1000).toFixed(0) }}K</div>
                <div class="text-success small">
                  <i class="fas fa-arrow-up"></i> +{{ monthlyGrowth }}% this month
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-xl-3 col-lg-6">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="flex-shrink-0">
                <div class="bg-warning bg-gradient rounded-circle p-3">
                  <i class="fas fa-chart-pie text-white"></i>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <div class="text-muted small">Budget Utilization</div>
                <div class="h3 mb-0">{{ budgetUtilization }}%</div>
                <div class="progress mt-2" style="height: 4px;">
                  <div class="progress-bar bg-warning" [style.width.%]="budgetUtilization"></div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      
      <div class="col-xl-3 col-lg-6">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-body">
            <div class="d-flex align-items-center">
              <div class="flex-shrink-0">
                <div class="bg-info bg-gradient rounded-circle p-3">
                  <i class="fas fa-users text-white"></i>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <div class="text-muted small">Team Efficiency</div>
                <div class="h3 mb-0">{{ teamEfficiency }}%</div>
                <div class="text-info small">
                  <i class="fas fa-chart-line"></i> Trending up
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Charts Section -->
    <div class="row g-4 mb-4">
      <!-- Project Gantt Chart -->
      <div class="col-12">
        <div class="card border-0 shadow-sm">
          <div class="card-header bg-white border-bottom-0 d-flex justify-content-between align-items-center">
            <h5 class="mb-0 d-flex align-items-center">
              <i class="fas fa-chart-gantt text-primary me-2"></i>
              Project Timeline (Gantt Chart)
            </h5>
            <div class="dropdown">
              <button class="btn btn-outline-secondary btn-sm dropdown-toggle" type="button" data-bs-toggle="dropdown">
                All Projects
              </button>
              <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#">All Projects</a></li>
                <li><a class="dropdown-item" href="#">Office Complex Alpha</a></li>
                <li><a class="dropdown-item" href="#">Residential Tower Beta</a></li>
                <li><a class="dropdown-item" href="#">Shopping Mall Gamma</a></li>
                <li><a class="dropdown-item" href="#">Industrial Park Delta</a></li>
              </ul>
            </div>
          </div>
          <div class="card-body">
            <div class="gantt-legend mb-3">
              <div class="d-flex gap-4">
                <div class="d-flex align-items-center">
                  <div class="legend-color bg-success me-2" style="width: 12px; height: 12px; border-radius: 2px;"></div>
                  <small>Completed</small>
                </div>
                <div class="d-flex align-items-center">
                  <div class="legend-color bg-primary me-2" style="width: 12px; height: 12px; border-radius: 2px;"></div>
                  <small>In Progress</small>
                </div>
                <div class="d-flex align-items-center">
                  <div class="legend-color bg-warning me-2" style="width: 12px; height: 12px; border-radius: 2px;"></div>
                  <small>Planned</small>
                </div>
                <div class="d-flex align-items-center">
                  <div class="legend-color bg-danger me-2" style="width: 12px; height: 12px; border-radius: 2px;"></div>
                  <small>Delayed</small>
                </div>
              </div>
            </div>
            <div style="height: 400px; max-height: 400px; overflow: hidden;">
              <canvas 
                baseChart
                [data]="ganttChartData"
                [options]="ganttOptions"
                [type]="'bar'">
              </canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row g-4 mb-4">
      <!-- Monthly Progress Chart -->
      <div class="col-xl-8">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-white border-bottom-0 d-flex justify-content-between align-items-center">
            <h5 class="mb-0 d-flex align-items-center">
              <i class="fas fa-chart-line text-success me-2"></i>
              Monthly Project Progress
            </h5>
            <div class="btn-group" role="group">
              <button type="button" class="btn btn-outline-primary btn-sm active">Month</button>
              <button type="button" class="btn btn-outline-primary btn-sm">Quarter</button>
              <button type="button" class="btn btn-outline-primary btn-sm">Year</button>
            </div>
          </div>
          <div class="card-body">
            <canvas 
              baseChart
              [data]="monthlyProgressData"
              [options]="chartOptions"
              [type]="'line'"
              height="300">
            </canvas>
          </div>
        </div>
      </div>

      <!-- Recent Activities & Team Status -->
      <div class="col-xl-4">
        <div class="card border-0 shadow-sm h-100">
          <div class="card-header bg-white border-bottom-0">
            <h5 class="mb-0 d-flex align-items-center">
              <i class="fas fa-clock text-info me-2"></i>
              Recent Activities
            </h5>
          </div>
          <div class="card-body">
            <div class="activity-list">
              <div *ngFor="let activity of recentActivities" class="activity-item border-bottom pb-3 mb-3">
                <div class="d-flex justify-content-between align-items-start">
                  <div class="activity-content">
                    <div class="activity-title fw-semibold">{{ activity.title }}</div>
                    <div class="activity-description text-muted small">{{ activity.description }}</div>
                    <div class="activity-time text-primary small">
                      <i class="fas fa-clock me-1"></i>{{ activity.time }}
                    </div>
                  </div>
                  <span class="badge" [ngClass]="{
                    'bg-success': activity.type === 'completed',
                    'bg-primary': activity.type === 'updated',
                    'bg-warning': activity.type === 'started',
                    'bg-info': activity.type === 'assigned'
                  }">{{ activity.type }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

  <!-- Project Analytics Section -->
  <div class="analytics-section">
    <h3 class="analytics-title">Full Project Analytics</h3>
    
    <!-- Filter Controls -->
    <div class="filter-controls">
      <div class="filter-row">
        <div class="filter-group">
          <label>Zone</label>
          <select [(ngModel)]="selectedZone" class="form-select">
            <option value="">All</option>
            <option *ngFor="let zone of zoneOptions" [value]="zone">{{ zone }}</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Floor</label>
          <select [(ngModel)]="selectedFloor" class="form-select">
            <option value="">All</option>
            <option *ngFor="let floor of floorOptions" [value]="floor">{{ floor }}</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Category</label>
          <select [(ngModel)]="selectedCategory" class="form-select">
            <option value="">All</option>
            <option *ngFor="let category of categoryOptions" [value]="category">{{ category }}</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Type</label>
          <select [(ngModel)]="selectedType" class="form-select">
            <option value="">All</option>
            <option *ngFor="let type of typeOptions" [value]="type">{{ type }}</option>
          </select>
        </div>
        <div class="filter-group">
          <label>Data Date</label>
          <input type="date" [(ngModel)]="endDate" class="form-control">
        </div>
      </div>
    </div>

    <!-- Key Metrics Row -->
    <div class="project-key-metrics">
      <div class="key-metric-row">
        <div class="key-metric">
          <div class="metric-label">Contract Start</div>
          <div class="metric-value">{{ contractStart }}</div>
        </div>
        <div class="key-metric">
          <div class="metric-label">Contract Finish</div>
          <div class="metric-value">{{ contractFinish }}</div>
        </div>
        <div class="key-metric">
          <div class="metric-label">Forecasted Finish</div>
          <div class="metric-value">{{ forecastedFinish }}</div>
        </div>
        <div class="key-metric">
          <div class="metric-label">Delay/Ahead (Days)</div>
          <div class="metric-value" [ngClass]="{'text-danger': delayDays < 0, 'text-success': delayDays >= 0}">{{ delayDays }}</div>
        </div>
        <div class="key-metric">
          <div class="metric-label">Variance %</div>
          <div class="metric-value" [ngClass]="{'text-danger': variancePercent < 0, 'text-success': variancePercent >= 0}">{{ variancePercent }}%</div>
        </div>
        <div class="key-metric">
          <div class="metric-label">SPI</div>
          <div class="metric-value" [ngClass]="{'text-danger': spi < 1, 'text-success': spi >= 1}">{{ spi }}</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Dashboard Content -->
  <div class="row">
    <!-- Left Column -->
    <div class="col-md-8">
      <!-- Overall Cost and Total Est. Cost by Project -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Overall Cost and Total Est. Cost Selected by Project Name</h2>
        </div>
        <div class="row mb-4">
          <div class="col-12">
            <div class="chart-container">
              <canvas baseChart
                [data]="projectCostData"
                [options]="barChartOptions"
                [type]="'bar'">
              </canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Progress Analysis Charts Row -->
      <div class="row">
        <div class="col-md-6">
          <div class="dashboard-widget">
            <div class="widget-header">
              <h3 class="widget-title">Planned vs Actual % (Cost)</h3>
            </div>
            <div class="progress-metrics">
              <div class="progress-item">
                <span class="progress-label">Planned %</span>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 95.4%"></div>
                </div>
                <span class="progress-value">95.4%</span>
              </div>
              <div class="progress-item">
                <span class="progress-label">Actual %</span>
                <div class="progress-bar-container">
                  <div class="progress-bar actual" style="width: 108.1%"></div>
                </div>
                <span class="progress-value">108.1%</span>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="dashboard-widget">
            <div class="widget-header">
              <h3 class="widget-title">Planned vs Actual % (Manhour)</h3>
            </div>
            <div class="progress-metrics">
              <div class="progress-item">
                <span class="progress-label">Planned %</span>
                <div class="progress-bar-container">
                  <div class="progress-bar" style="width: 11.68%"></div>
                </div>
                <span class="progress-value">11.68%</span>
              </div>
              <div class="progress-item">
                <span class="progress-label">Actual %</span>
                <div class="progress-bar-container">
                  <div class="progress-bar actual" style="width: 10.81%"></div>
                </div>
                <span class="progress-value">10.81%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Progress Curves -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Progress Curve - Cost</h2>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="chart-container">
              <canvas baseChart
                [data]="sCurveData"
                [options]="lineChartOptions"
                [type]="'line'">
              </canvas>
            </div>
          </div>
        </div>
      </div>

      <!-- Project Gantt Chart / Timeline -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Current date selection for projects</h2>
          <div class="date-timeline">
            <span class="timeline-date">02/01/2019</span>
            <div class="timeline-bar"></div>
            <span class="timeline-date">04/02/2019</span>
            <div class="timeline-bar"></div>
            <span class="timeline-date">09/03/2019</span>
            <div class="timeline-bar"></div>
            <span class="timeline-date">12/04/2019</span>
          </div>
        </div>
        <div class="project-timeline">
          <canvas baseChart
            [data]="ganttData"
            [options]="barChartOptions"
            [type]="'bar'">
          </canvas>
        </div>
      </div>

      <!-- Progress vs Actual Activity Wise -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Planned vs Actual % (Activity Wise)</h2>
        </div>
        <div class="activity-progress-list">
          <div class="activity-item">
            <span class="activity-name">Slab Unreinforced Concrete</span>
            <div class="activity-progress">
              <div class="progress-bars">
                <div class="planned-bar" style="width: 85%"></div>
                <div class="actual-bar" style="width: 71.54%"></div>
              </div>
              <div class="progress-labels">
                <span class="planned-label">Early Planned %</span>
                <span class="actual-label">Actual %</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Project Delay Trend -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Project Delay / Ahead Trend (Days)</h2>
        </div>
        <div class="row">
          <div class="col-md-12">
            <div class="chart-container">
              <canvas baseChart
                [data]="delayTrendData"
                [options]="lineChartOptions"
                [type]="'line'">
              </canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Right Column -->
    <div class="col-md-4">
      <!-- Task Categories -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Total Tasks by Task Category</h2>
        </div>
        <div class="task-category-chart">
          <div class="chart-wrapper">
            <div class="donut-chart-container">
              <canvas baseChart
                [data]="progressData"
                [options]="doughnutOptions"
                [type]="'doughnut'">
              </canvas>
              <div class="chart-center-value">
                <div class="center-number">84</div>
                <div class="center-label">Total Tasks</div>
              </div>
            </div>
            <div class="chart-legend">
              <div class="legend-item">
                <span class="legend-color" style="background-color: #f67280;"></span>
                <span>Pending</span>
                <span class="legend-value">72</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #3cba9f;"></span>
                <span>Concept Dev.</span>
                <span class="legend-value">14</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #6dc0d5;"></span>
                <span>Detail Design</span>
                <span class="legend-value">14</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #8e5ea2;"></span>
                <span>Systems</span>
                <span class="legend-value">16</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #e8c3b9;"></span>
                <span>Other</span>
                <span class="legend-value">12</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Total Resources by Color -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Total Resources by Color</h2>
        </div>
        <div class="resources-chart">
          <div class="chart-wrapper">
            <div class="donut-chart-container">
              <canvas baseChart
                [data]="budgetData"
                [options]="doughnutOptions"
                [type]="'doughnut'">
              </canvas>
              <div class="chart-center-value">
                <div class="center-number">446</div>
                <div class="center-label">Total Resources</div>
              </div>
            </div>
            <div class="chart-legend">
              <div class="legend-item">
                <span class="legend-color" style="background-color: #f67280;"></span>
                <span>Red</span>
                <span class="legend-value">17%</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #3cba9f;"></span>
                <span>Green</span>
                <span class="legend-value">12%</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #6dc0d5;"></span>
                <span>Blue</span>
                <span class="legend-value">21%</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #8e5ea2;"></span>
                <span>Purple</span>
                <span class="legend-value">21%</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #e8c3b9;"></span>
                <span>Other</span>
                <span class="legend-value">29%</span>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Critical Issues Tracker -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Critical Issues Tracker</h2>
        </div>
        <div class="row mb-3">
          <div class="col-6">
            <div class="chart-wrapper">
              <canvas baseChart
                [data]="issueTrackerData"
                [options]="doughnutOptions"
                [type]="'pie'">
              </canvas>
            </div>
            <div class="chart-legend-small">
              <div class="legend-item">
                <span class="legend-color" style="background-color: #3e95cd;"></span>
                <span>Open: 22</span>
              </div>
              <div class="legend-item">
                <span class="legend-color" style="background-color: #3cba9f;"></span>
                <span>Closed: 6</span>
              </div>
            </div>
          </div>
          <div class="col-6">
            <div class="chart-wrapper">
              <canvas baseChart
                [data]="issueSeverityData"
                [options]="barChartOptions"
                [type]="'bar'">
              </canvas>
            </div>
            <div class="severity-legend">
              <div>Minimal: 6</div>
              <div>Moderate: 7</div>
              <div>Critical: 10</div>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Major Points -->
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Major Points to be Focused on:</h2>
        </div>
        <ol class="focus-points">
          <li>SPI for Sep-23 is less than 1 which means that the project is behind the schedule</li>
          <li>Critical issues need immediate attention - 10 critical issues pending</li>
          <li>Manpower shortage in Civil department - only 64% of required resources available</li>
          <li>Project currently 44 days behind schedule</li>
        </ol>
      </div>
    </div>
  </div>

  <!-- Recent Projects Widget (Bottom) -->
  <div class="row">
    <div class="col-md-6 mb-4">
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Recent Projects</h2>
          <a routerLink="/projects" class="widget-link">View All</a>
        </div>
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Name</th>
                <th>Status</th>
                <th>Budget</th>
              </tr>
            </thead>
            <tbody>
              @if (loading) {
                <tr>
                  <td colspan="3" class="text-center">
                    <div class="spinner-border" role="status">
                      <span class="visually-hidden">Loading...</span>
                    </div>
                  </td>
                </tr>
              } @else if (projects.length === 0) {
                <tr>
                  <td colspan="3" class="text-center">No projects found</td>
                </tr>
              } @else {
                @for (project of projects; track project.id) {
                  <tr>
                    <td>
                      <a [routerLink]="['/projects', project.id]">{{ project.name }}</a>
                    </td>
                    <td>
                      <span class="badge" [ngClass]="'bg-' + getStatusClass(project.status)">
                        {{ project.status }}
                      </span>
                    </td>
                    <td>{{ project.totalBudget | currency:'EUR' }}</td>
                  </tr>
                }
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Recent Suppliers -->
    <div class="col-md-6 mb-4">
      <div class="dashboard-widget">
        <div class="widget-header">
          <h2 class="widget-title">Recent Suppliers</h2>
          <a routerLink="/suppliers" class="widget-link">View All</a>
        </div>
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Name</th>
                <th>Contact</th>
                <th>Email</th>
              </tr>
            </thead>
            <tbody>
              @if (loading) {
                <tr>
                  <td colspan="3" class="text-center">
                    <div class="spinner-border" role="status">
                      <span class="visually-hidden">Loading...</span>
                    </div>
                  </td>
                </tr>
              } @else if (suppliers.length === 0) {
                <tr>
                  <td colspan="3" class="text-center">No suppliers found</td>
                </tr>
              } @else {
                @for (supplier of suppliers; track supplier.id) {
                  <tr>
                    <td>
                      <a [routerLink]="['/suppliers', supplier.id]">{{ supplier.name }}</a>
                    </td>
                    <td>{{ supplier.contactName }}</td>
                    <td>{{ supplier.email }}</td>
                  </tr>
                }
              }
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Professional Summary Footer -->
    <div class="row g-4">
      <div class="col-12">
        <div class="card border-0 shadow-sm bg-primary text-white">
          <div class="card-body">
            <div class="row text-center">
              <div class="col-md-3">
                <div class="h2 mb-0">€{{ (totalRevenue / 1000000).toFixed(1) }}M</div>
                <small>Total Project Value</small>
              </div>
              <div class="col-md-3">
                <div class="h2 mb-0">{{ teamEfficiency }}%</div>
                <small>Overall Efficiency</small>
              </div>
              <div class="col-md-3">
                <div class="h2 mb-0">{{ projectsOnTime }}/{{ totalProjects }}</div>
                <small>Projects On Schedule</small>
              </div>
              <div class="col-md-3">
                <div class="h2 mb-0">{{ currentLiveTasks + currentCompletedTasks }}</div>
                <small>Total Tasks</small>
              </div>
            </div>
            <div class="text-center mt-3">
              <small class="opacity-75">Last updated: {{ getCurrentDate() }} | Construction Manager Pro v2.0</small>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>